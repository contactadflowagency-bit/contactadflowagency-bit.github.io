<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dashboard lead√≥w ‚Äî Firma1</title>

<style>
body{font-family:Arial;background:#f4f7fa;margin:0;padding:12px}
.card{max-width:1300px;margin:auto;background:#fff;border-radius:12px;padding:16px}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
th{background:#fafafa}
.status{padding:4px 8px;border-radius:6px;color:#fff;font-weight:700}
.s-nowy{background:#9c27b0}
.s-nie_odebral{background:#ff9800}
.s-odrzucony{background:#f44336}
.s-wizyta_umowiona{background:#009688}
</style>
</head>

<body>
<div class="card">
<h2>üìä Dashboard lead√≥w ‚Äî Firma1</h2>
<div id="loading">≈Åadowanie danych‚Ä¶</div>

<table id="table" style="display:none">
<thead>
<tr>
  <th>ID</th>
  <th>Data</th>
  <th>Pacjent</th>
  <th>Telefon</th>
  <th>Email</th>
  <th>Status</th>
  <th>Kampania</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
/* ====== KONFIG ====== */
const API_URL = "https://script.google.com/macros/s/XXX/exec";
const TOKEN = "FIRMA1_SECRET_123";
const FIRMA = "Firma1";

/* ====== HELPERS ====== */
function statusClass(s){
  s=(s||'').toLowerCase();
  if(s.includes('nie'))return's-nie_odebral';
  if(s.includes('odrz'))return's-odrzucony';
  if(s.includes('wizyta'))return's-wizyta_umowiona';
  return's-nowy';
}
function fmt(d){
  if(!d)return'';
  d=new Date(d);
  return d.toLocaleString('pl-PL');
}

/* ====== LOAD ====== */
fetch(`${API_URL}?action=list&firma=${FIRMA}&token=${TOKEN}`)
.then(r=>r.json())
.then(res=>{
  if(!res.success) throw res.error;
  const tbody=document.querySelector('tbody');
  res.rows.forEach(r=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${r.id}</td>
      <td>${fmt(r.created)}</td>
      <td>${r.name||''}</td>
      <td>${r.phone||''}</td>
      <td>${r.email||''}</td>
      <td><span class="status ${statusClass(r.status)}">${r.status||'nowy'}</span></td>
      <td>${r.campaign||''}</td>`;
    tbody.appendChild(tr);
  });
  document.getElementById('loading').style.display='none';
  document.getElementById('table').style.display='table';
})
.catch(e=>{
  document.getElementById('loading').innerText='‚õî Brak dostƒôpu';
});
</script>
</body>
</html>
