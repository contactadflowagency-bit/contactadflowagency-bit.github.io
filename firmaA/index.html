<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Leady</title>
<style>

body {
  font-family: Arial, sans-serif;
  background: #f4f6f9;
  margin: 0;
}

/* Szeroko≈õƒá zoptymalizowana ‚Äî suwak poziomy znika */
.wrap {
  max-width: 1300px;
  margin: 20px auto;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

/* Nag≈Ç√≥wek */
h1 {
  margin-top: 0;
  text-align: center;
  font-size: 26px;
  color: #333;
}

/* Filtry ‚Äî uk≈Çad C */
.filters {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-gap: 14px;
  margin-bottom: 12px;
}

.filter-row {
  display: contents;
}

.filters input,
.filters select {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 14px;
}

/* Linia z 2 polami dat */
.double {
  grid-template-columns: repeat(2, 1fr);
}

/* Licznik lead√≥w */
.counter-box {
  text-align: center;
  margin: 14px 0 20px 0;
  font-size: 15px;
  color: #444;
}

/* Tabela */
table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  font-size: 14px;
}

th {
  background: #eef1f6;
  padding: 10px;
  text-align: left;
  border-bottom: 2px solid #ddd;
  cursor: pointer;
}

td {
  padding: 8px;
  border-bottom: 1px solid #eee;
}

tr:hover {
  background: #f9f9f9;
}

/* Kolumny o minimalnej szeroko≈õci */
.col-lp { width: 40px; }
.col-id { width: 60px; text-align: center; }
.col-date { width: 120px; }
.col-updated { width: 120px; }
.col-reaction { width: 110px; }
.col-status { width: 110px; }
.col-email { width: 180px; }
.col-phone { width: 120px; }
.col-campaign { width: 120px; }

/* Statusy */
.status {
  padding: 3px 8px;
  border-radius: 6px;
  font-size: 13px;
  color: white;
}

.status.oczekuje { background: #777; }
.status.nowy { background: #007bff; }
.status.proces { background: #ff9800; }
.status.sukces { background: #28a745; }
.status.brak { background: #444; }
.status.koniec { background: #9c27b0; }

/* Przyciski */
.button-clear {
  background: #ccc;
  padding: 8px 10px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.button-clear:hover {
  background: #bbb;
}

</style>
</head>
<body>

<div class="wrap">

<h1>Panel Lead√≥w</h1>

<!-- FILTRY - OPCJA C -->
<div class="filters">

  <!-- RzƒÖd 1 -->
  <input id="search" type="text" placeholder="üîç Szukaj..." />
  <select id="statusFilter">
    <option value="">Wszystkie statusy</option>
    <option value="nowy">Nowy</option>
    <option value="w trakcie">W trakcie</option>
    <option value="sukces">Sukces</option>
    <option value="brak">Brak kontaktu</option>
    <option value="zakonczony">Zako≈Ñczony</option>
  </select>

  <select id="campaignFilter">
    <option value="">Wszystkie kampanie</option>
    <option value="Facebook">Facebook</option>
    <option value="Google">Google</option>
    <option value="Landing">Landing Page</option>
    <option value="Referral">Referral</option>
  </select>

  <!-- RzƒÖd 2 -->
  <input id="dateFrom" type="date" />
  <input id="dateTo" type="date" />

  <!-- RzƒÖd 3 -->
  <select id="sortSelect">
    <option value="">Sortuj</option>
    <option value="date_desc">Data (najnowsze)</option>
    <option value="date_asc">Data (najstarsze)</option>
    <option value="status">Status</option>
    <option value="campaign">Kampania</option>
  </select>

  <select id="autoRefresh">
    <option value="0">Auto-od≈õwie≈ºanie: off</option>
    <option value="30">co 30 sek</option>
    <option value="60">co 60 sek</option>
  </select>

  <button class="button-clear" id="clearFilters">Wyczy≈õƒá</button>

</div>

<!-- LICZNIK -->
<div class="counter-box">
  Wy≈õwietlane leady: <span id="counter">0</span> /
  <span id="counterTotal">0</span>
</div>

<!-- TABELA -->
<table>
  <thead>
    <tr>
      <th>Lp</th>
      <th>Data</th>
      <th>Pacjent</th>
      <th>Telefon</th>
      <th>Email</th>
      <th>Cel</th>
      <th>Status</th>
      <th>Aktualizacja</th>
      <th>Czas reakcji</th>
      <th>Kampania</th>
      <th>ID</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

</div>

<script>

/* --------------------
   PRZYK≈ÅADOWE DANE
--------------------- */
let leads = [
  {
    id: 101,
    createdText: "2025-02-01",
    name: "Jan Kowalski",
    phone: "500600700",
    email: "jan@example.com",
    cel: "Konsultacja",
    statusRaw: "nowy",
    updatedText: "2025-02-02",
    reaction: "5 min",
    campaign: "Facebook"
  },
  {
    id: 102,
    createdText: "2025-02-03",
    name: "Anna Nowak",
    phone: "500111222",
    email: "anna@example.com",
    cel: "Wizyta",
    statusRaw: "sukces",
    updatedText: "2025-02-03",
    reaction: "2 min",
    campaign: "Google"
  }
];

/* --------------------
   STATUS ‚Üí KOLOR
--------------------- */
function statusClassFor(s) {
  if (!s) return "oczekuje";
  s = s.toLowerCase();
  if (s.includes("now")) return "nowy";
  if (s.includes("trak")) return "proces";
  if (s.includes("suk")) return "sukces";
  if (s.includes("brak")) return "brak";
  if (s.includes("kon")) return "koniec";
  return "oczekuje";
}

/* --------------------
   ESCAPE HTML
--------------------- */
function escapeHtml(t) {
  return t == null ? "" : String(t).replace(/[&<>"']/g, m => ({
    "&": "&amp;", "<": "&lt;", ">": "&gt;", "\"": "&quot;", "'": "&#39;"
  }[m]));
}

/* --------------------
   RENDEROWANIE TABELI
--------------------- */
function renderRows(rows) {
  const tableBody = document.getElementById("tableBody");
  tableBody.innerHTML = "";

  rows.forEach((r, idx) => {
    const lp = idx + 1;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="col-lp">${escapeHtml(lp)}</td>
      <td class="col-date">${escapeHtml(r.createdText)}</td>
      <td>${escapeHtml(r.name)}</td>
      <td class="col-phone">${escapeHtml(r.phone)}</td>
      <td class="col-email">${escapeHtml(r.email)}</td>
      <td>${escapeHtml(r.cel)}</td>
      <td class="col-status"><span class="status ${statusClassFor(r.statusRaw)}">${escapeHtml(r.statusRaw)}</span></td>
      <td class="col-updated">${escapeHtml(r.updatedText)}</td>
      <td class="col-reaction">${escapeHtml(r.reaction)}</td>
      <td class="col-campaign">${escapeHtml(r.campaign)}</td>
      <td class="col-id">${escapeHtml(r.id)}</td>
    `;
    tableBody.appendChild(tr);
  });

  document.getElementById("counter").textContent = rows.length;
  document.getElementById("counterTotal").textContent = leads.length;
}

/* --------------------
   FILTROWANIE
--------------------- */
function applyFilters() {
  let filtered = [...leads];

  const search = document.getElementById("search").value.toLowerCase();
  const statusF = document.getElementById("statusFilter").value;
  const campF = document.getElementById("campaignFilter").value;
  const dFrom = document.getElementById("dateFrom").value;
  const dTo = document.getElementById("dateTo").value;
  const sort = document.getElementById("sortSelect").value;

  if (search) {
    filtered = filtered.filter(l =>
      (l.name + l.phone + l.email + l.campaign + l.cel)
        .toLowerCase()
        .includes(search)
    );
  }

  if (statusF) {
    filtered = filtered.filter(l =>
      (l.statusRaw || "").toLowerCase().includes(statusF)
    );
  }

  if (campF) filtered = filtered.filter(l => l.campaign === campF);

  if (dFrom) filtered = filtered.filter(l => l.createdText >= dFrom);
  if (dTo) filtered = filtered.filter(l => l.createdText <= dTo);

  if (sort === "date_desc") filtered.sort((a,b) => b.createdText.localeCompare(a.createdText));
  if (sort === "date_asc") filtered.sort((a,b) => a.createdText.localeCompare(b.createdText));
  if (sort === "status") filtered.sort((a,b) => (a.statusRaw||"").localeCompare(b.statusRaw||""));
  if (sort === "campaign") filtered.sort((a,b) => a.campaign.localeCompare(b.campaign));

  renderRows(filtered);
}

/* --------------------
   CLEAR
--------------------- */
document.getElementById("clearFilters").onclick = () => {
  document.getElementById("search").value = "";
  document.getElementById("statusFilter").value = "";
  document.getElementById("campaignFilter").value = "";
  document.getElementById("dateFrom").value = "";
  document.getElementById("dateTo").value = "";
  document.getElementById("sortSelect").value = "";
  applyFilters();
};

/* --------------------
   AUTO REFRESH
--------------------- */
let refreshInterval = null;

document.getElementById("autoRefresh").onchange = () => {
  const val = Number(document.getElementById("autoRefresh").value);
  if (refreshInterval) clearInterval(refreshInterval);
  if (val > 0) refreshInterval = setInterval(applyFilters, val * 1000);
};

/* --------------------
   LISTENERY
--------------------- */
document.querySelectorAll("#search, #statusFilter, #campaignFilter, #dateFrom, #dateTo, #sortSelect")
  .forEach(el => el.addEventListener("input", applyFilters));

/* --------------------
   START
--------------------- */
renderRows(leads);

</script>

</body>
</html>
